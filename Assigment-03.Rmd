---
title: "BIOL390: Assignment 3"
author: "Mitch Lueken"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output:
  html_document: default
  pdf_document: default
---

```{R, lieberry, echo = FALSE, results = 'hide', message = FALSE, warnings = FALSE}
library(tidyverse)
library(lattice)
library(kableExtra)
# R needs to know what in the world a "Tidyverse" is, and to learn how to knit graphs and tables
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warnings = FALSE)
# The finished html does not neet all the R console output clogging it up
```

```{css, cap}
caption {
      color: black;
}
# CSS wants captions to be black, because any other color would make horrible captions
```

```{r, data, message = FALSE}
data <- read_csv("https://www.zoology.ubc.ca/~whitlock/ABD/teaching/datasets/03/03e3SticklebackPlates.csv")
names(data) <- c("Genotype", "Plates")
# R needs to get its data from somewhere, and to know what to call it
```

## Three-spined sticklebacks

```{perl, fishies, engine.path='C:\\Strawberry\\perl\\bin\\perl.exe', results = 'asis'}
print("Text about fishies. <i>Fishy fishicus</i> is a type of fish. It does fish things, mostly.")
# perl prints text, results knitted as a raw markdown string
```

```{r, graphics, fig.align = 'center', fig.cap = '<b>Figure 1:</b> Lateral plate morphology of the three-spine stickleback. Â© Windsor E. Aguirre', fig.width = 400}
# The chunk options center the figure, give it a caption, and set its width
knitr::include_graphics("https://www.researchgate.net/profile/Windsor_Aguirre/publication/285915049/figure/fig2/AS:318190618988545@1452873963743/Lateral-plate-morphs-of-Gasterosteus-aculeatus-A-low-B-partial-C-complete-From_W640.jpg")
# This code tells knitr where to find a picture to display
```

## Hardy Weinberg conditions

```{python, POTUS41, results = 'asis'}
print("The Hardy Weinberg equation:  ")
print("$p^{2}+2pq+q^{2}=1$")
# Python prints the HW equation as markdown text
```
	
```{Rcpp, words}
#include <Rcpp.h>
#include <string>
using namespace std;

// [[Rcpp::export]]
void words() {
	Rcpp::Rcout << "Why are we talking about Harvey Weinstein? Here's a brief paragraph about him.";
}
// C++ function whichs returns a string.
```

```{r, wordiness, results = 'asis'}
words()
# R function call to the previously defined C++ function
```

## Data analyses

```{r, histogram, fig.align = 'center', fig.cap = "<b>Figure 2:</b> Frequency distribution of lateral plate counts by genotype"}
histogram(~ Plates | Genotype, 
		  data = data, 
		  breaks = seq(0,70,by=2),
		  layout = c(1, 3), 
		  col = "firebrick")
# Here's a history-o-gram
```

* Things
* about
* the
* histogram  
And a SegWay

```{r, tafl}
knitr::kable(data %>% group_by(Genotype) %>% summarize(N = n(), 
			 			  Mean = mean(Plates), 
			 			  Median = median(Plates), 
			 			  StdDev = sd(Plates)), 
			 align = c('l','c','c','c','c'), 
			 digits = 2,
			 format = "html", 
			 caption = "<b>Table 1:</b> Summary of lateral plate numbers by genotype.",
			 table.attr = "style='width:70%;'") %>% kable_styling(position = "center")
# Comment explaining this mess of code
```

```{r, boxplot, fig.align = 'center', fig.cap = "<b>Figure 3:</b> Number of lateral plates by genotype"}
ggplot(data, aes(x=Genotype, y=Plates, fill="firebrick")) + 
	geom_boxplot(outlier.colour="black", outlier.size=3) + 
	ylim(0,80) + 
	guides(fill=FALSE, color=FALSE) +
	theme_bw()
# Useful comment that explains things
```

<!-- Insert science here, plus a segfault -->

```{r, ANOVA}
knitr::kable(anova(lm(Plates ~ Genotype, data = data)),
			 digits = 3, 
			 format = "html", 
			 caption = "<b>Table 2:</b> One-way ANOVA analysis of lateral plate numbers by genotype",
			 table.attr = "style='width:70%;'") %>% kable_styling(position = "center")
# Insert helpful comment here
```

## Conclusions

<!-- Insert helpful summary paragraph here -->

## Reference

Colosimo, P. F., Peichel, C. L., Nereng, K., Blackman, B. K., Shapiro, M. D., Schluter, D., & Kingsley, D. M. (2004). The Genetic Architecture of Parallel Armor Plate Reduction in Threespine Sticklebacks. *PLoS Biology*, *2*(5), e109. https://doi.org/10.1371/journal.pbio.0020109
